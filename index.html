<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Court App – Step Build</title>

<!-- Excel library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
body{font-family:Arial;background:#f4f4f4;padding:10px}
.section{background:#fff;padding:10px;margin-bottom:15px;border-radius:6px}
h3{margin-top:0}
input,button{width:100%;padding:8px;margin:6px 0}
button{background:#1976d2;color:#fff;border:none;border-radius:4px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #333;padding:4px;font-size:12px}
#msg{margin-top:5px;color:green;font-weight:bold}
</style>
</head>

<body>

<!-- ================= STEP 1 : CALENDAR (FINAL) ================= -->
<div class="section">
  <h3>STEP 1 – Working Date (FINAL)</h3>

  <label>काम करने की तारीख चुनें</label>
  <input type="date" id="workDate">

  <div id="dateStatus"></div>
</div>

<!-- ================= STEP 2 : EXCEL (TESTING) ================= -->
<div class="section">
  <h3>STEP 2 – Excel Upload (TESTING)</h3>

  <input type="file" id="excelFile">
  <button onclick="uploadExcel()">Upload Excel</button>

  <div id="msg"></div>

  <table id="table"></table>
</div>

<script>
/* ========= STEP 1 FINAL ========= */
document.getElementById("workDate").addEventListener("change", function(){
  document.getElementById("dateStatus").innerHTML =
    "Working date set: <b>" + this.value + "</b>";
});

/* ========= STEP 2 TESTING ========= */
function uploadExcel(){
  let file = document.getElementById("excelFile").files[0];
  if(!file){
    alert("No Excel selected");
    return;
  }

  let reader = new FileReader();
  reader.onload = function(e){
    let wb = XLSX.read(e.target.result, {type:"binary"});
    let sheet = XLSX.utils.sheet_to_json(
      wb.Sheets[wb.SheetNames[0]]
    );

    alert("Excel Uploaded (TEST PASS)");

    drawTable(sheet);
  };
  reader.readAsBinaryString(file);
}

function drawTable(data){
  let t = document.getElementById("table");
  t.innerHTML = "";
  if(data.length === 0) return;

  let heads = Object.keys(data[0]);
  t.innerHTML =
    "<tr>" + heads.map(h=>"<th>"+h+"</th>").join("") + "</tr>";

  data.forEach(r=>{
    t.innerHTML +=
      "<tr>" +
      heads.map(h=>"<td>"+(r[h]||"")+"</td>").join("") +
      "</tr>";
  });
}
</script>

</body>
</html>
